<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Jens Roeser" />
    
    
    <title>Workshop 17: Model assumptions</title>

        <script src="model-assumptions_files/header-attrs-2.1/header-attrs.js"></script>
        <script src="model-assumptions_files/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="model-assumptions_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="model-assumptions_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="model-assumptions_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="model-assumptions_files/navigation-1.1/tabsets.js"></script>
        <link href="model-assumptions_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="model-assumptions_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="model-assumptions_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="model-assumptions_files/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="model-assumptions_files/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
        
      <h1 class="title">Workshop 17: Model assumptions</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Workshop 17: Model assumptions</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#lecture-review">Lecture review</a></li>
      <li><a href="#learning-outcomes">Learning outcomes</a></li>
      <li><a href="#setup">Setup</a></li>
      <li><a href="#normal-distribution">Normal distribution</a></li>
      <li><a href="#central-limit-theorem">Central limit theorem</a></li>
      <li><a href="#summary">Summary</a></li>
      <li><a href="#references">References</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Jens Roeser</p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> Compiled 2021-01-27</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="lecture-review" class="section level1">
<h1>Lecture review</h1>
<ul>
<li>Parametric models (<em>t</em>-test, ANOVA, linear regression) make assumptions about their input (the data_.</li>
<li>Assumptions related to the normal distribution
<ul>
<li>data must be continuous</li>
<li>observations must be independent and identically distributed</li>
</ul></li>
<li>The normal distribution is assumed because of the central limit theorem</li>
<li>Homogeneity of variance</li>
<li>Linearity: continuous predictors must be linear</li>
</ul>
</div>
<div id="learning-outcomes" class="section level1">
<h1>Learning outcomes</h1>
<p>This workshop, along with the lecture on model assumptions should give you the opportunity to be able to</p>
<ul>
<li>name central properties and aspects of the normal distribution.</li>
<li>understand the conceptual idea of the central limit theorem.</li>
<li>use basic simulations in R to understand both.</li>
</ul>
<p>For revision of central limit theorem and normal distribution see <span class="citation">Matloff (<a href="#ref-matloff2019probability" role="doc-biblioref">2019</a>)</span> chapter 9.7 and <span class="citation">Baguley (<a href="#ref-baguley2012serious" role="doc-biblioref">2012</a>)</span> chapter 2.4.1</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>You need the package <code>psyntur</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(psyntur) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">packageVersion</span>(<span class="st">&quot;psyntur&quot;</span>) <span class="co"># should be version 0.0.2</span></span></code></pre></div>
<pre><code>## [1] &#39;0.0.2&#39;</code></pre>
</div>
<div id="normal-distribution" class="section level1">
<h1>Normal distribution</h1>
<p>To draw out a normal distribution, all we need to know is its mean and its standard deviation.</p>
<div id="simulate-normal-distributed-data" class="section level2">
<h2>Simulate normal distributed data</h2>
<p>The function <code>rnorm</code> allows us to randomly sample normal distributed data (r=random, norm=normal). The function takes three parameter values, i.e. the number of samples <code>n</code>, the mean, and the standard deviation <code>sd</code>.</p>
<p>Create random distributed data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># Number of obervations to be sampled.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>mean &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co"># True population mean of the distribution. </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>sd &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># True population sd of the distributions</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)</span></code></pre></div>
<p>These are our randomly sampled observations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>## [1] 443.9524 476.9823 655.8708 507.0508 512.9288</code></pre>
<p>Aside, functions like <code>rnorm</code> allow us to control population parameters. In reality we rarely know the population mean, say, the average time it takes to recover from COVID, but we can estimate it from large enough samples. These population parameters are conventionally indicated with Greek letters, i.e. called <span class="math inline">\(\mu\)</span> (mu; the population mean) and <span class="math inline">\(\sigma\)</span> (sigma; the population standard deviation).</p>
<p>Plot the “fake” data from above.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">histogram</span>(x, <span class="dt">data =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-5-1.png" width="192" /></p>
<p>Here are the mean of the sample:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 519.357</code></pre>
<p>and the standard deviation of the sample:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">sd</span>(x)</span></code></pre></div>
<pre><code>## [1] 81.10218</code></pre>
<p>Note, your values will be slightly different from mine because we take random samples.</p>
</div>
<div id="questions" class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Questions</h2>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p>Are these data in the histogram normal distributed? Why do you think they are (or are not) normal distributed?</p>
<p><strong>Answer:</strong> In theory yes (we know that <code>rnorm</code> is generating normal distributed data); in practice no, the distribution of the data is almost uniform. Reasons: the plot doesn’t show the characteristic bell curve because the sample was very small (<em>n</em>=5).</p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p>Compare the sample mean and the sample standard deviation to our population mean and population variance. Are they different? Remember, we are in the almost unique sitation to know the population parameters. Why do you think are the sample mean and standard deviation different from the population mean and standard deviation?</p>
<p><strong>Answer:</strong> The sample mean and standard deviation are different from their population values. They are different because our sample was not normal distributed / sample was too small (<em>n</em>=5).</p>
</div>
</div>
<div id="tasks" class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Tasks</h2>
<div id="task-1" class="section level3">
<h3>Task 1</h3>
<p>Create a histogram with sample size <em>n=</em>1000. Run the code. What changes did you make in the code? How has the histogram changed? Calculate the sample mean and sd again. How did they change?</p>
</div>
<div id="task-2" class="section level3">
<h3>Task 2</h3>
<p>Create a histogram with sample size <em>n=</em>1000 and a <em>sd</em> of 10. What changes did you make in the code? How has the histogram changed? Calculate the sample mean and sd again. How did they change?</p>
</div>
<div id="task-3" class="section level3">
<h3>Task 3</h3>
<p>If we know the population mean and population variance, we know everything we need to know to create data we would be expected under the normal distribution. Let’s do this for IQ which has a population mean of 100 and a population sd of 15. Use an <em>n</em> of 1000 samples and plot a histogram of IQ.</p>
</div>
</div>
<div id="the-area-under-the-curve" class="section level2">
<h2>The area under the curve</h2>
<p>Let’s continue with the IQ example from the lecture. We know the population values, which is extremly handy. Here is a density plot of IQ with a mean of 100 and a sd of 15. This should look similar to your plot from task 3. Except instead of counts / frequency, the density plot describes the relative likelihood of IQ values.</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-8-1.png" width="192" /></p>
<p>Remeber, the area underneth the curve must sum to 1. In other words the likelihood of an observation to take on an IQ of any value under the curve is 1 (or 100%). The likelihood of a value to be outside this area is 0 (%). Those are the extremes.</p>
<p>We can now use the <code>pnorm</code> (probability normal) function to calculate areas underneath the curve. Again, we take the population means of IQ.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>mean &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>sd &lt;-<span class="st"> </span><span class="dv">15</span></span></code></pre></div>
<p>Say we want to know the probability of observing a person with an IQ <strong>below</strong> 100 which is the red shaded area in the density plot:</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-10-1.png" width="192" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>In other words, 50% (0.5) of the population have an IQ below 100.</p>
</div>
<div id="tasks-1" class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Tasks</h2>
<div id="task-1-1" class="section level3">
<h3>Task 1</h3>
<p>Calculate the probability of observing a person with an IQ below 75 corresponding to the area shaded in this plot:</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-12-1.png" width="192" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">75</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="co"># Answer</span></span></code></pre></div>
<pre><code>## [1] 0.04779035</code></pre>
</div>
<div id="task-2-1" class="section level3">
<h3>Task 2</h3>
<p>Calculate the probability of observing a person with an IQ <em>above</em> 75 corresponding to the area shaded in the plot below. Remember the entire area underneth the curve sums to 1 (100%).</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-14-1.png" width="192" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">75</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="co"># Answer: we can us 1-pnorm() because the area under the curve sums to 1 </span></span></code></pre></div>
<pre><code>## [1] 0.9522096</code></pre>
</div>
<div id="task-3-1" class="section level3">
<h3>Task 3</h3>
<p>Calculate the probability of observing a person with an IQ between 95 and 110 corresponding to the area shaded in the plot below.</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-16-1.png" width="192" /></p>
<p>As an example, here is the probability of observing a person with an IQ between 75 and 95</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">95</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">75</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)</span></code></pre></div>
<pre><code>## [1] 0.321651</code></pre>
<p>which is the probability of observing a person with an IQ below 95</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">95</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)</span></code></pre></div>
<pre><code>## [1] 0.3694413</code></pre>
<p>but removing the probability of observing a person with an IQ below 75</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">75</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)</span></code></pre></div>
<pre><code>## [1] 0.04779035</code></pre>
</div>
<div id="task-4" class="section level3">
<h3>Task 4</h3>
<p>Calculate the probability of observing a person with an IQ between 99.9 and 100.1 corresponding to the area shaded in the plot below.</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-20-1.png" width="192" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="fl">100.1</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="fl">99.9</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="co"># Answer</span></span></code></pre></div>
<pre><code>## [1] 0.005319191</code></pre>
<p>Notice that even though the population mean is 100, the likelihood of observing a person with an IQ between 99.9 and 100.1 is almost 0 (0.5%). This is a property of continuous distributions; the probability of observing a specific value like exactly 100 is leaning towards 0 (i.e. almost impossible).</p>
</div>
<div id="task-5" class="section level3">
<h3>Task 5</h3>
<p>Calculate the probability of observing a person with an IQ of below 60 or above 140; see the area shaded in the plot.</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-22-1.png" width="192" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="kw">pnorm</span>(<span class="dv">60</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">140</span>, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)) <span class="co"># Answer</span></span></code></pre></div>
<pre><code>## [1] 0.007660761</code></pre>
</div>
<div id="task-6-bonus" class="section level3">
<h3>Task 6 (bonus)</h3>
<p>Calculate the probability of observing a person with an IQ two standard deviations below or above the mean (see plot). Reminder the population mean of IQ is 100 and its standard deviation is 15.</p>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-24-1.png" width="192" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>lower_tail &lt;-<span class="st"> </span>mean <span class="op">-</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>sd)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pnorm</span>(lower_tail, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd) <span class="co"># Answer: we can do this because the distribution is symmetric</span></span></code></pre></div>
<pre><code>## [1] 0.04550026</code></pre>
</div>
</div>
</div>
<div id="central-limit-theorem" class="section level1">
<h1>Central limit theorem</h1>
<p>We know that the central limit theorem works if the samples approaches infinity (or is at least large enough) and the samples and independent and identially distributed (iid; see lecture). The central limit theorem states that the sampling distribution will approach normality when the sample size increase, <strong>regardless of the shape of the distribution we are sampling from</strong>.</p>
<p>Let’s look at the depression example from the lecture. The CES-D scale for self-report depression <span class="citation">(Radloff, <a href="#ref-radloff1977ces" role="doc-biblioref">1977</a>)</span> contains 22 items. Say we ask participants to indicate on a 5-point Likert scale to what extent they agree with each of the 22 statements (1 = strongly disagree – 5 = Strongly agree).</p>
<ul>
<li>Item 1: I was bothered by things that usually don’t bother me.</li>
<li>Item 2: I had a poor appetite.</li>
<li>Item 3: I did no feel like eating, even tohugh I should have been hungry.</li>
<li>…</li>
<li>Item 22: I didn’t enjoy life.</li>
</ul>
<div id="questions-1" class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Questions</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p>What type of data are the responses to each item?</p>
<p><em>Answer:</em> Ordinal / categorical / nominal but not continuous.</p>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<p>Are responses to these items are normal distirbuted? Why (or why not)?</p>
<p><em>Answer:</em> No. There are 5 response categories that have an implicit order (ordinal response). Because - limited response options - bound between an upper and lower limit - inherently order - the liklihood of responses betweeen, say, 1 and 2 is not defined - response categories are not equidistant – the psychological distance between strongly disagree and moderately disagree might be different in the head of the participant than the distance between moderately agree and strongly agree.</p>
</div>
</div>
<div id="simulation" class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills">Simulation</h2>
<p>We will see now, why we can still use linear-regression models that assume normally distributed data, even though the data we obtain are not normal distirbuted.</p>
<div id="task-1-2" class="section level3">
<h3>Task 1</h3>
<p>First we need to define the response options available to the participant.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co"># response options</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>response &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span> <span class="co"># people can only respond with a number from 1 to 5</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a><span class="co"># Check out the vector</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>response <span class="co"># numbers from 1 to 5 (easy)</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>We can use <code>sample</code> to take random samples from <code>response</code>. Try out; there is a <span class="math inline">\(\frac{1}{5}\)</span> chance the number you obtained is the same as mine. Do you know why?</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">sample</span>(response, <span class="dt">size =</span> <span class="dv">1</span>) <span class="co"># Sample 1 random number between 1 and 5</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p>What’s the code for sampling 2 random numbers?</p>
</div>
<div id="task-2-2" class="section level3">
<h3>Task 2</h3>
<p>To sample more than 5 random numbers we need to set <code>replace = TRUE</code> to allow the same number to be sample more than once (called sampling with replacement).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">sample</span>(response, <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="co"># Sample 6 random numbers between 1 and 5</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 5 3 3</code></pre>
<p>Remember that the depression scale above has 22 items. So if we want to simulate one participant who responds to every of the 22 items (at random), what would you need to change <code>size</code> to?</p>
</div>
<div id="task-3-2" class="section level3">
<h3>Task 3</h3>
<p>You probably worked out in Task 3 that <code>size</code> has to be 22. Lets save the result in <code>ppt_1</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a>ppt_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sample</span>(response, <span class="dt">size =</span> <span class="dv">22</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="co"># Simulate one participant</span></span></code></pre></div>
<p>Let’s plot these data to see how they are distributed. Use <code>histogram()</code> and set <code>data</code> to <code>NULL</code> (cause we don’t use a data frame) and set <code>x</code> to <code>ppt_1</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="co"># create histogram of ppt_1</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="kw">histogram</span>(<span class="dt">data =</span> <span class="ot">NULL</span>, <span class="dt">x =</span> ppt_<span class="dv">1</span>) <span class="co"># answer</span></span></code></pre></div>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-31-1.png" width="192" /></p>
<p>Is this distribution normal? Why or why not?</p>
<p><strong>Answer</strong>: No the distribution is not normal for the same reasons as above (not a continuous but an ordinal variable).</p>
</div>
<div id="task-4-1" class="section level3">
<h3>Task 4</h3>
<p>We’ve seen how we can sample random data for one participant that answers all 22 depression items. Now, lets demonstrated the central limit theorem. Remember that the central limit theorem states that we will arrive at a normal distribution if our sample is approaching infinity (or a large number) regardless of the shape of the distribution we’re sampling from.</p>
<p>We don’t learn much from sampling data for one fictive participant. We can use the <code>replicate</code> function to do the same for 2 participants.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="kw">replicate</span>(<span class="dv">2</span>, <span class="kw">sample</span>(response, <span class="dt">size =</span> <span class="dv">22</span>, <span class="dt">replace =</span> T))</span></code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,]    5    1
##  [2,]    5    2
##  [3,]    3    4
##  [4,]    1    5
##  [5,]    2    5
##  [6,]    5    3
##  [7,]    5    1
##  [8,]    4    4
##  [9,]    5    1
## [10,]    2    1
## [11,]    1    3
## [12,]    1    4
## [13,]    3    1
## [14,]    1    3
## [15,]    5    5
## [16,]    1    3
## [17,]    2    2
## [18,]    4    5
## [19,]    4    5
## [20,]    3    3
## [21,]    1    2
## [22,]    2    2</code></pre>
<p>What’s the code to do the same for 10 participants?</p>
<p>Let’s save the data for two participants in <code>two_ppts</code> and calculate the means for each column (i.e. participant) using <code>colMeans</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a>two_ppts &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">2</span>, <span class="kw">sample</span>(response, <span class="dt">size =</span> <span class="dv">22</span>, <span class="dt">replace =</span> T))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>two_ppts_means &lt;-<span class="st"> </span><span class="kw">colMeans</span>(two_ppts)</span></code></pre></div>
<p>Here is a histogram of two participant means:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="kw">histogram</span>(<span class="dt">data =</span> <span class="ot">NULL</span>, <span class="dt">x =</span> two_ppts_means)</span></code></pre></div>
<p><img src="model-assumptions_files/figure-html/unnamed-chunk-34-1.png" width="192" /></p>
<p>This was good but still not very impressive. Get a histogram for 10, 100 and then 1000 fictive participants.</p>
<p>Share the plot that you think shows a normal distribution best in your Teams chat:</p>
<p><strong>To share your plot:</strong> Click on <code>Export</code> in the <code>Plots</code> panel, then <code>Copy to Clipboard ...</code> and <code>Copy Plot</code>, then go to your Teams chat, click in the chat box and click <code>CTRL</code> + <code>V</code> to insert the plot.</p>
</div>
<div id="task-5-bonus" class="section level3">
<h3>Task 5 (bonus)</h3>
<p>You feel the previous task wasn’t challenging enough? Try to do the same histogram of the sampling distribution again but instead of means, use total; i.e. replace <code>colMeans</code> with <code>colSums</code>. The central tendency theorem works not just for means but also for totals and even for standard deviations.</p>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Congratulations, you just</p>
<ul>
<li>simulated normal distributed data</li>
<li>learned how to use means and standard deviations to calculate the likelihood of observing values</li>
<li>used a simulation to create a sampling distribution from a sample of non-normal distributed data and</li>
<li>demonstrated the central limit theorem.</li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-baguley2012serious">
<p>Baguley, T. (2012). <em>Serious stats: A guide to advanced statistics for the behavioral sciences</em>. Macmillan International Higher Education.</p>
</div>
<div id="ref-matloff2019probability">
<p>Matloff, N. (2019). <em>Probability and statistics for data science: Math + R + data</em>. CRC Press.</p>
</div>
<div id="ref-radloff1977ces">
<p>Radloff, L. S. (1977). The CES-D scale: A self-report depression scale for research in the general population. <em>Applied Psychological Measurement</em>, <em>1</em>(3), 385–401.</p>
</div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 	 	$('#content img').addClass("image-thumb");
		
		$('#content img').addClass("image-lb");
	$('#content').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
	    delegate: '.image-lb',
	    gallery: {enabled: false },
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
